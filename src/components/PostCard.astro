---
import type { CollectionEntry } from 'astro:content';
import { getBase } from '../consts';

interface Props {
  post: CollectionEntry<'posts'>;
}

const { post } = Astro.props;
const base = getBase();

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}

const excerpt = post.data.excerpt || post.body?.slice(0, 150) + '...';
---

<article class="post">
  <a href={`${base}posts/${post.id}`} class="title">
    <h1>{post.data.title}</h1>
  
    {post.data.cover && <img class="post-cover" src={`${base}${post.data.cover}`} alt={post.data.title} />}
    <div class="entry">
      {excerpt}
    </div>
    <div class="date">
      {formatDate(post.data.date)}
    </div>
  </a>
</article>
